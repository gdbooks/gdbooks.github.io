<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Characters | Introduction</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.3.0">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
    

        
    
    
    <link rel="next" href="./Iso_MakeItems.html" />
    
    
    <link rel="prev" href="./Iso_MakeMap.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="17.2" data-basepath="." data-revision="Wed Sep 30 2015 01:50:35 GMT-0700 (Pacific Daylight Time)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="Chapter1.html">
            
                
                    <a href="./Chapter1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Starting Out
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="FrameworksSources.html">
            
                
                    <a href="./FrameworksSources.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Managers
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="Game.html">
            
                
                    <a href="./Game.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Game
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="Program.html">
            
                
                    <a href="./Program.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        Program
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="Chapter2.html">
            
                
                    <a href="./Chapter2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Why Tiles?
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="Chapter3.html">
            
                
                    <a href="./Chapter3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Map Format
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="Chapter6.html">
            
                
                    <a href="./Chapter6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Creating Tiles
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="Practice/PracticeCh6.html">
            
                
                    <a href="./Practice/PracticeCh6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        On Your Own
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="Chapter5.html">
            
                
                    <a href="./Chapter5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Map Tools
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="Chapter8.html">
            
                
                    <a href="./Chapter8.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        The Hero
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="Practice/PracticeTheHero.html">
            
                
                    <a href="./Practice/PracticeTheHero.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        On Your Own
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" data-path="Chapter9.html">
            
                
                    <a href="./Chapter9.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Keys To Move
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1" data-path="Practice/PracticeMoving.html">
            
                
                    <a href="./Practice/PracticeMoving.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                        On Your Own
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8" data-path="Chapter10.html">
            
                
                    <a href="./Chapter10.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        Hit The Wall
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9" data-path="Chapter11.html">
            
                
                    <a href="./Chapter11.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        Open The Door
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1" data-path="cleanup.html">
            
                
                    <a href="./cleanup.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.</b>
                        
                        Cleaning Up
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="borders.html">
            
                
                    <a href="./borders.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.</b>
                        
                        Screen Borders
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="10" data-path="Chapter12.html">
            
                
                    <a href="./Chapter12.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        Jumping
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="10.1" data-path="jumpconfig.html">
            
                
                    <a href="./jumpconfig.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.1.</b>
                        
                        Configurable Jumping
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="11" data-path="Chapter13.html">
            
                
                    <a href="./Chapter13.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                        Clouds
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="12" data-path="Chapter15.html">
            
                
                    <a href="./Chapter15.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>12.</b>
                        
                        Simple Enemy
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="13" data-path="Chapter17.html">
            
                
                    <a href="./Chapter17.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>13.</b>
                        
                        Shooting
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="14" data-path="Chapter18.html">
            
                
                    <a href="./Chapter18.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>14.</b>
                        
                        Getting Items
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="15" data-path="Chapter20.html">
            
                
                    <a href="./Chapter20.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>15.</b>
                        
                        Scrolling
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="15.1" data-path="Chapter21.html">
            
                
                    <a href="./Chapter21.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>15.1.</b>
                        
                        Limit Scrolling
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="16" data-path="Chapter22.html">
            
                
                    <a href="./Chapter22.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>16.</b>
                        
                        Depth
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="16.1" data-path="SpeerateCollisionAndRendering.html">
            
                
                    <a href="./SpeerateCollisionAndRendering.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>16.1.</b>
                        
                        Collision &amp; Rendering
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="16.2" data-path="AddingAHouse.html">
            
                
                    <a href="./AddingAHouse.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>16.2.</b>
                        
                        Visual Tweaks
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="16.3" data-path="DepthBuffer.html">
            
                
                    <a href="./DepthBuffer.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>16.3.</b>
                        
                        Depth Buffer
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="17" data-path="Chapter23.html">
            
                
                    <a href="./Chapter23.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>17.</b>
                        
                        Ismetric View
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="17.1" data-path="Iso_MakeMap.html">
            
                
                    <a href="./Iso_MakeMap.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>17.1.</b>
                        
                        Map
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="17.2" data-path="Iso_MakeCharacters.html">
            
                
                    <a href="./Iso_MakeCharacters.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>17.2.</b>
                        
                        Characters
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="17.3" data-path="Iso_MakeItems.html">
            
                
                    <a href="./Iso_MakeItems.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>17.3.</b>
                        
                        Items &amp; Projectiles
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="18" data-path="Chapter24.html">
            
                
                    <a href="./Chapter24.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>18.</b>
                        
                        Mouse To Move
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="19" data-path="Chapter25.html">
            
                
                    <a href="./Chapter25.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>19.</b>
                        
                        X Iso Mouse
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="20" data-path="Chapter26.html">
            
                
                    <a href="./Chapter26.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>20.</b>
                        
                        X Iso Scroll
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="21" data-path="Chapter29.html">
            
                
                    <a href="./Chapter29.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>21.</b>
                        
                        X Slopes
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="22" data-path="Chapter30.html">
            
                
                    <a href="./Chapter30.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>22.</b>
                        
                        X Hexagons
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="23" data-path="Chapter7.html">
            
                
                    <a href="./Chapter7.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>23.</b>
                        
                        X More Tiles
                    </a>
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Published with GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >Introduction</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="characters">Characters</h1>
<p>Moving the characters into an isometric view might be a bit of a challenge. We&apos;re going to have to refactor far more code here than in the previous sections of the tutorial.</p>
<p>While doing all of this, keep in mind we are not doing collisions or any logic in an isometric space. Isometric is only a view, we still handle collisions and items in world space. </p>
<p>Recall there are three important spaces: world space, camera space and screen space. Applying an isometric projection only changes the camera space. &quot;Applying an isometric projection&quot; might sound fancy, but reality, that&apos;s what the <code>CartToIso</code> in <strong>Map.cs</strong> does.</p>
<h3 id="rendering-world-space">Rendering World Space</h3>
<p>Because we&apos;re doing all our logic in world space debugging will be a lot easyer if we can also see world space! If a collision looks wrong, it happens in an isometric view, but not in a top down view of world space then we know that the issue is render code and not collision code.</p>
<p>First, let&apos;s make a new variable in <strong>Game.cs</strong>. A public, static bool. Call it <code>ViewWorldSpace</code> and set it to false by default.</p>
<p>Update the <code>Update</code> function of <strong>Game.cs</strong>. Pick any key (I suggest &apos;U&apos;), when that key is pressed toggle the <code>ViewWorldSpace</code> boolean.</p>
<p>In the <code>Render</code> function find where offsetPosition.X and Y are hard coded. Wrap that bit of code in an if statment, we only want to hard code the X and Y if <code>ViewWorldSpace</code> is <strong>false</strong></p>
<p>Next, let&apos;s undo the isometric projection. In <strong>Map.cs</strong> find the  <code>CartToIso</code> and <code>IsoToCart</code> functions. If <code>Game.ViewWorldSpace</code> is true, return the arguments without any modification.</p>
<p>Last, we need to make a slight modification to the rendering code of <strong>Tile.cs</strong>. If <code>Game.ViewWorldSpace</code> is true, Draw a rectangle. The Location of the rectangle is going to be <code>WorldPosition</code>, while it&apos;s size is going to be 69 x 70. (69 is 1/2 the width of each tile, 70 is the height of each tile). Thse are the numbers we set up in the constructor of <strong>Map.cs</strong> for the size and position of tiles. If <code>Game.ViewWorldSpace</code> is false, render everything as usual.</p>
<p>Further more, when <code>Game.ViewWorldSpace</code> is true and we render a rectangle, if the tile is walkable render the rectangle in <code>Color.LightSteelBlue</code>, otherwise render it in <code>Color.LightSlateGray</code>.</p>
<p><strong>Run the game</strong> and toggle the display. Your non-isometric world view should look like this:</p>
<p><img src="Images/non_iso.PNG" alt="NON_ISO"></p>
<h3 id="no-more-30">No more 30</h3>
<p>Now that we can view world space just fine, we notice that the size of the world space tiles is MUCH larger than the size of our player and enemy tiles. Let&apos;s go ahead and fix this next.</p>
<p>The sizing issue happens because the map is rendering with our worlds current tile size, while the character an enemy have 30 hard coded for the tile size. That&apos;s no-bueno.</p>
<p>We have a global define in <strong>Game.cs</strong>, find the <code>tileSize</code> global variable and delete it. In it&apos;s place, add these two new defines:</p>
<pre><code class="lang-cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">int</span> TILE_W = <span class="hljs-number">69</span>; <span class="hljs-comment">// 138 / 2</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">int</span> TILE_H = <span class="hljs-number">70</span>; <span class="hljs-comment">// 70</span>
</code></pre>
<p>We just caused a lot of compiler errors be removing <code>tileSize</code>, go ahead and fix these. Instead of <code>tileSize</code>, use <code>TILE_W</code> and <code>TILE_H</code> wherever appropriate. Appy H to Y values and W to X values.</p>
<p>Now it&apos;s time to replace EVERY OTHER INSTANCE of 30. Search the entire project <em>(Control + shift + F)</em> for <strong>30</strong>, replace every instance with TILE_W or TILE_H, depending on which one is appropriate.</p>
<p>Update the constructor of <strong>Map.cs</strong> to use the constants from <code>Game</code>, instead of hard coding 138 / 2 and 70.</p>
<p>In <strong>Tile.cs</strong> we hard coded the debug render size to 69x70. Switch these to be the constants in <code>Game.cs</code>, also, there is a height text of 70 hard coded in there, change that 70 to <code>Game.TILE_H</code>.</p>
<p><strong>Run the game</strong>, if you switch into debug view, even tough link is the wrong size he can walk around the map. He just looks small. Confirm that collision and shooting work before moving on to the next section.</p>
<h4 id="display-the-character">Display the Character</h4>
<p>Let&apos;s take a little bit of time to refactor <strong>Character.cs</strong>. The first thing i&apos;m going to do is remove the code that renders the debug yellow square at the characters registration point.</p>
<p>Next, we&apos;re going to updat the character sprites. In <strong>PlayerCharacter.cs</strong> and in <strong>EnemyCharacter.cs</strong>, change the sprite sources to:</p>
<ul>
<li>AddSprite(&quot;Down&quot;, new Rectangle(52, 19, 85, 84)); </li>
<li>AddSprite(&quot;Up&quot;, new Rectangle(266, 19, 85, 84)); </li>
<li>AddSprite(&quot;Left&quot;, new Rectangle(155, 19, 85, 84)); </li>
<li>AddSprite(&quot;Right&quot;, new Rectangle(375, 19, 85, 84)); </li>
</ul>
<p>Back in <strong>Character.cs</strong>, let&apos;s go ahead and project these characters into an isometric space. In the <code>Render</code> method after the offset is applyed to <code>renderPosition</code>, but before the y correction takes place go ahead and call <code>Map.CartToIso</code>. </p>
<p><code>MapCartToIso</code> will transform <code>renderPosition</code> from a cartesian space into an isometric space. Do this the same way you have already done it for <strong>Tile.cs</strong></p>
<p>Lastly, back in <strong>Game.cs</strong>, go ahead and change <code>heroSheet</code> and <code>npcSheet</code> to point to the isometric sprite sheet. </p>
<p><strong>Run the game</strong>, the isometric view should look pretty close to correct. Moving around is going to be broken, but visually it&apos;s close to good. We&apos;re going to just ignore z-fighting issues for now. This is what your game should look like:</p>
<p><img src="Images/dont_move.PNG" alt="DONT_MOVE"></p>
<h3 id="moving-the-character">Moving the character</h3>
<p>If the moving code is broken, then it&apos;s broken in a few places. Switch to the overhead view and see if movement is broken... Well it&apos;s not really broken, but it&apos;s also not correct. We should only see squares in this view, not sprites. </p>
<p>In <strong>character.cs</strong>, update the render method so if <code>Game.ViewWorldSpace</code> is true, we draw a square (use the Rect getter for it&apos;s rectangle), make it <code>Color.SteelBlue</code>. If <code>Game.ViewWorldSpace</code> is false, draw the texture as usual.</p>
<p>Looking at our new debug render, the errors are quiet obvious! The player is bigger (wider) than the floor tiles. That&apos;s a pretty big no-no. And how exactly does the size in this screen translate to the size of the iso sprite? After all the iso sprite only takes up a part of each tile.</p>
<p>Just like the size of each tile is no longer the same as the size of it&apos;s sprite, the isometric size of the player tile is not the same as the size of its sprite. We have to apply the same transform to player as we do to tiles, so we are going to cut his width in half. How about the height? We will just make it the same as his width... For now.</p>
<p><img src="Images/tut16c.gif" alt="T16C"></p>
<p><code>Character</code> alredy has a <code>height</code> variable. Delete it. Change the constructor to just do nothing with the height argument, ignore it.</p>
<p>Inside the <code>Rect</code> getter, make two new local intgers: <code>width</code> and <code>height</code>. <code>width</code> is going to equal the current sprites width, divided by two. <code>height</code> is going to equal <code>width</code>. Return a rectangle at <code>Positon`, with a size of</code>width<code>,</code>height```. The if statement in here is no longer needed.</p>
<p>The <code>Center</code> getter already uses the <code>Rect</code> getter, there is nothing to change here.</p>
<p>In the <code>Corners</code> getter, change w to equal <code>Rect.Width</code> and h to equal <code>Rect.Height</code></p>
<p>Lastly, there is a reference to the old <code>height</code> variable inside of the <code>Render</code> function. Change the line to subtract <code>Rect.Height</code> instead of the old member. Also, because the if statment this is in no longer makes sense, change it to:</p>
<pre><code class="lang-cs"><span class="hljs-keyword">if</span> (SpriteSources[currentSprite][currentFrame].Height &gt; Rect.Height) {
</code></pre>
<p><strong>Run the game</strong>, walking around and collision should be working pretty well. Especially in overhead view:</p>
<p><img src="Images/side_by_side.png" alt="COMPARE"></p>
<h3 id="rendering-artifacts">Rendering artifacts</h3>
<p>We have a few rendering artifacts going on. The most obvious of which is the bits of tile that render above the character. This happens becuase what gets written into the depth buffer is a square. Even if a diamond is rendered to the clor buffer, a square is rendered to the depth buffer.</p>
<p>This square ends up putting pixels where they are not supposed to go! Open up <strong>GraphicsManager.cs</strong>, go to the <code>Initialize</code> function, and there are two lines commetned out:</p>
<ul>
<li><code>GL.AlphaFunc(AlphaFunction.Greater, 0.1f);</code></li>
<li><code>GL.Enable(EnableCap.AlphaTest);</code></li>
</ul>
<p>Go ahead and comment these two lines back in, they will make it so alpha (transparent) pixels don&apos;t get written into the depth buffer.</p>
<p>The next issue is that the character does not line up to the grid!</p>
<p><img src="Images/collision_error.png" alt="ERROR"></p>
<p>This is not an easy one to fix. The issue is our player sprite uses it&apos;s middle left as a registration point right now. But in an isometric view, everything needs to be modeled relative to a tile. Look at this picture again:</p>
<p><img src="Images/tut16c.gif" alt="T16C"></p>
<p>The + on the left marks the registration point, it&apos;s the top left for the floor tile. BUT, it also marks the registration point for the player! Notice how the players registration point doesn&apos;t actually touch the sprite! </p>
<p>So how do we figure out how much space we need to offset the player by? Looking at the picture, it&apos;s <code>(TileCenter - TileW * 0.5) - (PlayerCenter - PlayerW * 0.5)</code> Doing the math with our known numbers, that comes out to about <strong>25</strong>.</p>
<p>You could calculate this at runtime, to support different size enemies, but we&apos;re just going to keep it simple. So, where to apply this offset? In <strong>Character.cs</strong>, the <code>Render</code> function. Find where the <code>renderPosition</code> is projected into isometric space. Directly after that add 25 to it&apos;s X component!</p>
<p>There is one last bug. If you walk into an obstacle from the X direction you will first be behind it, but then quickly pop in front of it! We have to offset the X position of the player by 1 pixel just like we did the Y position of the player. Look at the top of the <code>Render</code> function in <strong>Character.cs</strong>, and offset X by 1 the same way Y is offset by 1.</p>
<p><strong>Run the game</strong>, everything should now work in an isometric environment. Your character can walk around, collide with walls and even enemies. As an adde bonus, the walls even have height to them!</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./Iso_MakeMap.html" class="navigation navigation-prev " aria-label="Previous page: Map"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./Iso_MakeItems.html" class="navigation navigation-next " aria-label="Next page: Items &amp; Projectiles"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
